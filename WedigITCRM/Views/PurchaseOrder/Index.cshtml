@model SearchPurchaseOrderViewModel

<div class="formcontainer">
    <div style="color : #17a2b8;" class="tableheadline">
        Indkøbsordrer
    </div>
    <br />
    <form id="searchForm" asp-controller="PurchaseOrder" asp-action="Index" method="get">
        <div class="form-row">
            <div class="col-2">
                <div class="input-select-room-for-icon">
                    <label asp-for="@Model.ReceivedStatus">Modtaget status</label>
                    <select asp-for="@Model.ReceivedStatus" asp-items="@Model.SearchByReceivedStatus" id="searchbyreceivedstatus" class="custom-select"></select>
                </div>
                <div class="icon-beside-input-select">
                    <i id="resetreceivedstatus" class="fa fa-times"></i>
                </div>
            </div>
            <div class="col-2">
                <div class="input-select-room-for-icon">
                    <label asp-for="@Model.VendorId">Leverandør</label>
                    <select asp-for="@Model.VendorId" asp-items="@Model.SearchByVendor" id="searchbyvendor" class="custom-select"></select>
                </div>
                <div class="icon-beside-input-select">
                    <i id="resetvendor" class="fa fa-times"></i>
                </div>
            </div>
            <div class="col-2">
                <div class="input-select-room-for-icon">
                    <label asp-for="@Model.PurchaseDocumentNumber">Indkøbsordre nr.</label>
                    <select asp-for="@Model.PurchaseDocumentNumber" asp-items="@Model.SearchByPurchaseDocumentNumber" id="searchbyPOdocumentno" class="custom-select"></select>
                </div>
                <div class="icon-beside-input-select">
                    <i id="resetpurchaseordernumber" class="fa fa-times"></i>
                </div>
            </div>
            <div class="col-2">
                <div class="input-icons">
                    <label for="searchfromdatepicker">Fra dato</label>
                    <i style="color : #17a2b8;" class="fa fa-calendar icon"></i>
                    <input asp-for="@Model.SearchFromDate" autocomplete="off" class="datepicker-input-field" id="searchfromdatepicker" />                  
                </div>
                <div class="icon-beside-input-datepicker">
                    <i id="resetfromdate" class="fa fa-times"></i>
                </div>
            </div>
            <div class="col-2">
                <div class="input-icons">
                    <label for="searchtodatepicker">Til dato</label>
                    <i style="color : #17a2b8;" class="fa fa-calendar icon"></i>
                    <input asp-for="@Model.SearchToDate" id="searchtodatepicker" autocomplete="off" class="datepicker-input-field" />
                </div>
                <div class="icon-beside-input-datepicker">
                    <i id="resettodate" class="fa fa-times"></i>
                </div>
            </div>

            <div class="col-2">
                <a asp-controller="PurchaseOrder" asp-action="CreatePO" style="margin-top: 18px; height: 37px" class="btn btn-info btn-lg">Ny indkøbsordre</a>
            </div>
        </div>
        <br />
        <br />
    </form>

    @if (Model != null)
    {
        if (Model.PurchaseOrdersViewLines.Count > 0)
        {
            <div class="rowcontainer">
                <div class="row purchaseorderindexheadlines">
                    <div class="col-2">Leverandør</div>
                    <div class="col-2">Orderdato</div>
                    <div class="col-2">Modtaget status</div>
                    <div class="col-2">Sendt til lev.</div>
                    <div class="col-2">Indkøbsordre nr.</div>
                    <div class="col-2">
                    </div>
                </div>
            </div>
            @foreach (var purchaseOrder in Model.PurchaseOrdersViewLines)
            {
                <div class="rowcontainer purchaseorderindexorderline">
                    <div class="row" id="@purchaseOrder.Id">
                        <div class="col-2">@purchaseOrder.VendorName</div>
                        <div class="col-2">@purchaseOrder.OurOrderingDate</div>
                        <div class="col-2">@purchaseOrder.ReceivedStatus</div>
                        <div class="col-2">@purchaseOrder.SendToVendorDate</div>
                        <div class="col-2">@purchaseOrder.PurchaseOrderDocumentNumber</div>
                        <div class="col-2">
                            <a asp-controller="PurchaseOrder" asp-action="ReorderPO" asp-route-purchaseOrderId="@purchaseOrder.Id"><i style="color : #17a2b8;" class="fa fa-ticket fa-2x fa-fw"></i></a>
                            <a asp-controller="PurchaseOrder" asp-action="EditPO" asp-route-purchaseOrderId="@purchaseOrder.Id"><i style="color : #17a2b8;" class="fa fa-pencil-square-o fa-2x fa-fw"></i></a>
                            <a asp-controller="PurchaseOrder" asp-action="receivePurchaseOrder" asp-route-purchaseOrderId="@purchaseOrder.Id"><i style="color : #17a2b8;" class="fa fa-envelope-open fa-2x fa-fw"></i></a>
                            <a asp-controller="PurchaseOrder" asp-action="Delete" asp-route-purchaseOrderId="@purchaseOrder.Id"><i style="color : #17a2b8;" class="fa fa-times fa-2x fa-fw"></i></a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="rowcontainer">
                <div class="row">
                    <div class="col-3">
                        Ingen indkøbsordrer fundet
                    </div>
                </div>
            </div>
        }
    }


    <br />
    <br />
    <div class="form-row">
        <div class="col-4">

            @Html.PagedListPager(Model.PurchaseOrdersViewLines, page => Url.Action("Index", new { page }), new PagedListRenderOptions
            {
                LiElementClasses = new string[] { "page-item" },
                PageClasses = new string[] { "page-link" },
                LinkToFirstPageFormat = "<< Første",
                LinkToPreviousPageFormat = "< Forrige",
                LinkToNextPageFormat = "Næste >",
                LinkToLastPageFormat = "sidste >>"
            })
        </div>

    </div>

</div>
@section Scripts {
    <script>


        $(document).ready(function () {

            $("#searchfromdatepicker").datetimepicker({
                timepicker: false,
                datepicker: true,
                hours12: false,
                regional: 'de',
                format: 'd-m-Y'
            });

            $.datetimepicker.setLocale('da');


            $("#searchtodatepicker").datetimepicker({
                timepicker: false,
                datepicker: true,
                hours12: false,
                format: 'd-m-Y'
            });

            $('#searchbyreceivedstatus').bind('change', function () {
                $("#searchForm").submit();
            });

            $('#searchbyvendor').bind('change', function () {
                $("#searchForm").submit();
            });

            $('#searchbyPOdocumentno').bind('change', function () {
                $("#searchForm").submit();
            });

            $('#searchfromdatepicker').bind('change', function () {
                $("#searchForm").submit();
            });

            $('#searchtodatepicker').bind('change', function () {
                $("#searchForm").submit();
            });

            $(document).on("click", ".fa-times", function (event) {
                var resetFieldId = $(this).attr("id");
                switch (resetFieldId) {
                    case "resetreceivedstatus":
                        $('#searchbyreceivedstatus').val("0");
                        break;
                    case "resetvendor":
                        $('#searchbyvendor').val("0");
                        break;
                    case "resetpurchaseordernumber":
                        $('#searchbyPOdocumentno').val("0");
                        break;
                    case "resetfromdate":
                        $('#searchfromdatepicker').val("");
                        break;
                    case "resettodate":
                        $('#searchtodatepicker').val("");
                        break;
                }
                $("#searchForm").submit();
                event.stopImmediatePropagation()
            });
        });
    </script>
}